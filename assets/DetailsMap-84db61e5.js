import{d as s,a as ne}from"./MapView-26b25d24.js";import{D as rt,E as S,G as se,R as F,S as Y,U as z,Q as ct,bg as oe,ad as ie,I as St,h as W,i as q,K as de,$ as Et,L as ce,a0 as Bt,a2 as pe,O as ue,P as ot,bh as he,M as It,bi as fe,bj as me,bk as we,a3 as ge,Z as xe,Y as ve,bl as ke,ay as bt,bm as Mt,aj as ye,bn as be,o as tt,j as st,a as A,_ as Me,u as $e,d as Ge,aX as _e,e as Ce,f as ze,g as $t,l as j,n as Ae,bo as it,k as pt,w as ut,m as Gt,c as _t,ax as Se,F as Ee,q as Be,s as Ie}from"./index-b050904d.js";import{c as Ct}from"./DetailsMapContainer-c284abbd.js";import{C as De,u as Te}from"./composables-708418ab.js";const Ne=rt({name:"ChevronLeft",render(){return S("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},S("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),Pe=c=>{const{fontWeight:l,textColor1:n,textColor2:a,textColorDisabled:_,dividerColor:g,fontSize:E}=c;return{titleFontSize:E,titleFontWeight:l,dividerColor:g,titleTextColor:n,titleTextColorDisabled:_,fontSize:E,textColor:a,arrowColor:a,arrowColorDisabled:_,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},je={name:"Collapse",common:se,self:Pe},Re=je,We=F("collapse","width: 100%;",[F("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[Y("disabled",[z("header","cursor: not-allowed;",[z("header-main",`
 color: var(--n-title-text-color-disabled);
 `),F("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),F("collapse-item","margin-left: 32px;"),ct("&:first-child","margin-top: 0;"),ct("&:first-child >",[z("header","padding-top: 0;")]),Y("left-arrow-placement",[z("header",[F("collapse-item-arrow","margin-right: 4px;")])]),Y("right-arrow-placement",[z("header",[F("collapse-item-arrow","margin-left: 4px;")])]),z("content-wrapper",[z("content-inner","padding-top: 16px;"),oe({duration:"0.15s"})]),Y("active",[z("header",[Y("active",[F("collapse-item-arrow","transform: rotate(90deg);")])])]),ct("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),ie("disabled",[Y("trigger-area-main",[z("header",[z("header-main","cursor: pointer;"),F("collapse-item-arrow","cursor: default;")])]),Y("trigger-area-arrow",[z("header",[F("collapse-item-arrow","cursor: pointer;")])]),Y("trigger-area-extra",[z("header",[z("header-extra","cursor: pointer;")])])]),z("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 `,[z("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),z("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),F("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),Le=Object.assign(Object.assign({},Et.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},triggerAreas:{type:Array,default:()=>["main","extra","arrow"]},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),Dt=ue("n-collapse"),Fe=rt({name:"Collapse",props:Le,setup(c,{slots:l}){const{mergedClsPrefixRef:n,inlineThemeDisabled:a,mergedRtlRef:_}=St(c),g=W(c.defaultExpandedNames),E=q(()=>c.expandedNames),L=de(E,g),O=Et("Collapse","-collapse",We,Re,c,n);function D(o){const{"onUpdate:expandedNames":M,onUpdateExpandedNames:N,onExpandedNamesChange:P}=c;N&&ot(N,o),M&&ot(M,o),P&&ot(P,o),g.value=o}function B(o){const{onItemHeaderClick:M}=c;M&&ot(M,o)}function h(o,M,N){const{accordion:P}=c,{value:x}=L;if(P)o?(D([M]),B({name:M,expanded:!0,event:N})):(D([]),B({name:M,expanded:!1,event:N}));else if(!Array.isArray(x))D([M]),B({name:M,expanded:!0,event:N});else{const v=x.slice(),I=v.findIndex(k=>M===k);~I?(v.splice(I,1),D(v),B({name:M,expanded:!1,event:N})):(v.push(M),D(v),B({name:M,expanded:!0,event:N}))}}ce(Dt,{props:c,mergedClsPrefixRef:n,expandedNamesRef:L,slots:l,toggleItem:h});const T=Bt("Collapse",_,n),H=q(()=>{const{common:{cubicBezierEaseInOut:o},self:{titleFontWeight:M,dividerColor:N,titlePadding:P,titleTextColor:x,titleTextColorDisabled:v,textColor:I,arrowColor:k,fontSize:G,titleFontSize:y,arrowColorDisabled:$,itemMargin:Q}}=O.value;return{"--n-font-size":G,"--n-bezier":o,"--n-text-color":I,"--n-divider-color":N,"--n-title-padding":P,"--n-title-font-size":y,"--n-title-text-color":x,"--n-title-text-color-disabled":v,"--n-title-font-weight":M,"--n-arrow-color":k,"--n-arrow-color-disabled":$,"--n-item-margin":Q}}),K=a?pe("collapse",void 0,H,c):void 0;return{rtlEnabled:T,mergedTheme:O,mergedClsPrefix:n,cssVars:a?void 0:H,themeClass:K==null?void 0:K.themeClass,onRender:K==null?void 0:K.onRender}},render(){var c;return(c=this.onRender)===null||c===void 0||c.call(this),S("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),Oe=rt({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(c){return{onceTrue:he(It(c,"show"))}},render(){return S(we,null,{default:()=>{const{show:c,displayDirective:l,onceTrue:n,clsPrefix:a}=this,_=l==="show"&&n,g=S("div",{class:`${a}-collapse-item__content-wrapper`},S("div",{class:`${a}-collapse-item__content-inner`},this.$slots));return _?fe(g,[[me,c]]):c?g:null}})}}),He={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Ue=rt({name:"CollapseItem",props:He,setup(c){const{mergedRtlRef:l}=St(c),n=ge(),a=xe(()=>{var h;return(h=c.name)!==null&&h!==void 0?h:n}),_=ve(Dt);_||ke("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:g,props:E,mergedClsPrefixRef:L,slots:O}=_,D=q(()=>{const{value:h}=g;if(Array.isArray(h)){const{value:T}=a;return!~h.findIndex(H=>H===T)}else if(h){const{value:T}=a;return T!==h}return!0});return{rtlEnabled:Bt("Collapse",l,L),collapseSlots:O,randomName:n,mergedClsPrefix:L,collapsed:D,triggerAreas:It(E,"triggerAreas"),mergedDisplayDirective:q(()=>{const{displayDirective:h}=c;return h||E.displayDirective}),arrowPlacement:q(()=>E.arrowPlacement),handleClick(h){let T="main";bt(h,"arrow")&&(T="arrow"),bt(h,"extra")&&(T="extra"),E.triggerAreas.includes(T)&&_&&!c.disabled&&_.toggleItem(D.value,a.value,h)}}},render(){const{collapseSlots:c,$slots:l,arrowPlacement:n,collapsed:a,mergedDisplayDirective:_,mergedClsPrefix:g,disabled:E,triggerAreas:L}=this,O=Mt(l.header,{collapsed:a},()=>[this.title]),D=l["header-extra"]||c["header-extra"],B=l.arrow||c.arrow;return S("div",{class:[`${g}-collapse-item`,`${g}-collapse-item--${n}-arrow-placement`,E&&`${g}-collapse-item--disabled`,!a&&`${g}-collapse-item--active`,L.map(h=>`${g}-collapse-item--trigger-area-${h}`)]},S("div",{class:[`${g}-collapse-item__header`,!a&&`${g}-collapse-item__header--active`]},S("div",{class:`${g}-collapse-item__header-main`,onClick:this.handleClick},n==="right"&&O,S("div",{class:`${g}-collapse-item-arrow`,key:this.rtlEnabled?0:1,"data-arrow":!0},Mt(B,{collapsed:a},()=>{var h;return[S(ye,{clsPrefix:g},{default:(h=c.expandIcon)!==null&&h!==void 0?h:()=>this.rtlEnabled?S(Ne,null):S(De,null)})]})),n==="left"&&O),be(D,{collapsed:a},h=>S("div",{class:`${g}-collapse-item__header-extra`,onClick:this.handleClick,"data-extra":!0},h))),S(Oe,{clsPrefix:g,displayDirective:_,show:!a},l))}}),Ve={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},qe=A("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),Ke=A("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 176v160"},null,-1),Qe=A("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 256H176"},null,-1),Xe=[qe,Ke,Qe],Ze=rt({name:"AddCircleOutline",render:function(l,n){return tt(),st("svg",Ve,Xe)}}),Ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Je=A("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M416 128L192 384l-96-96"},null,-1),ta=[Je],ea=rt({name:"Checkmark",render:function(l,n){return tt(),st("svg",Ye,ta)}});const Tt=c=>(Be("data-v-0574b0d1"),c=c(),Ie(),c),aa=Tt(()=>A("div",{id:"details-tooltip"},[A("div",{class:"tooltip-title"}),A("div",{class:"tooltip-citation"})],-1)),ra={class:"details-work-title"},la=["href"],na={class:"details-work-citation"},sa=["href"],oa={key:0,class:"details-work-abstract"},ia=Tt(()=>A("div",{id:"details-map"},null,-1)),zt=0,b="#333447",At="#514efd",lt="lightgrey",nt="1.5px",J=1e3,da={__name:"DetailsMap",props:["sizes"],setup(c){const l=c,n=$e(),a=Ge(),_=_e(),g=Ce(),E=Te();ze(()=>{L(),B(),h(),at.value=s.select("#details-tooltip")});function L(){const t=s.select("#details-map");o.value=t.style("width").replace("px","")}const O=ne(()=>{D()},500);$t(()=>n.width,()=>{O()});function D(){L(),B(),h()}function B(){s.select("#svg-details-chart").remove(),M(),N()}function h(){Wt(),Ot()}const T=W(null),H=W(null),K=q(()=>{const t=a.detailsMapGraph.children.length;let e=s.max(a.detailsMapGraph.children.map(i=>a.detailsMapGraph.type==="works"?i.data.children.length:i.children.length));e=e||2;const r=a.detailsMapGraph.type==="works"?k:G,p=a.detailsMapGraph.type==="works"?G:k;let d=null;return a.detailsMapGraph.type==="works"?d=t>=e?I+t*r:I+e*p:d=t>e?I+t*r:I+e*p,n.isMobile?I+r*a.detailsMapGraph.children.length+e*p:d}),o=W(null);function M(){T.value=s.select("#details-map").append("svg").attr("id","svg-details-chart").attr("viewBox",`0 0 ${o.value} ${K.value}`),H.value=T.value.append("g").attr("id","details-chart-container").attr("transform",`translate(${zt}, ${zt})`)}function N(){Pt(),jt(),Rt()}const P=W(null),x=W(null),v=W(null),I=l.sizes.worksBandwidth*5,k=l.sizes.worksBandwidth*3,G=l.sizes.worksBandwidth*1.5,y=l.sizes.worksBandwidth*.5,$=l.sizes.worksBandwidth*.5*2,Q=s.easeElasticOut.amplitude(1).period(.4);function Nt(){if(n.isMobile){let t=a.detailsMapGraph.children.length;const e=a.detailsMapGraph.type==="works"?k:G,r=a.detailsMapGraph.type==="works"?t*e:t*e+G*1.5;return`translate(0, ${I+r})`}else return`translate(${o.value*.5}, ${I})`}function Pt(){P.value=H.value.append("g").attr("transform","translate(0, 0)")}function jt(){x.value=H.value.append("g").attr("transform",`translate(0, ${I})`)}function Rt(){v.value=H.value.append("g").attr("transform",Nt())}function Wt(){a.detailsMapGraph.type==="works"||(a.detailsMapGraph.type==="sdgs"?Lt():Ft())}function Lt(){const r=P.value.append("g").attr("class","title-group").attr("transform",`translate(0,-${l.sizes.worksBandwidth*4})`).append("a").attr("xlink:href",a.detailsMapGraph.data.url).attr("target","_blank").append("g").attr("transform",`translate(${l.sizes.worksBandwidth}, ${l.sizes.worksBandwidth})`);r.append("circle").attr("r",y).attr("stroke",b).attr("fill",b),r.append("text").text(`SDG ${a.detailsMapGraph.data.id}`).attr("x",$).attr("y",0).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor","start"),r.append("rect").attr("x",$).attr("y",0).attr("fill",a.detailsMapGraph.data.color).attr("opacity",.4).attr("width",a.detailsMapGraph.data.labelBbox.width).attr("height",a.detailsMapGraph.data.labelBbox.height),r.append("text").text(a.detailsMapGraph.data.name).attr("x",$).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor","start"),P.value.select(".title-group").transition().duration(J).ease(Q).attr("transform","translate(0,0)")}function Ft(){const r=P.value.append("g").attr("class","title-group").attr("transform",`translate(0,-${l.sizes.worksBandwidth*4})`).append("a").attr("xlink:href",a.detailsMapGraph.data.url).attr("target","_blank").append("g").attr("transform",`translate(${l.sizes.worksBandwidth}, ${l.sizes.worksBandwidth})`);r.append("circle").attr("r",y).attr("stroke",b).attr("fill",b),r.append("text").text(a.detailsMapGraph.data.name).attr("x",$).attr("y",0).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","start"),P.value.select(".title-group").transition().duration(J).ease(Q).attr("transform","translate(0,0)")}function Ot(){a.detailsMapGraph.type==="works"?Ht(a.detailsMapGraph.children,Ut,ht):Zt(a.detailsMapGraph.children,Yt,vt)}function Ht(t,e,r){x.value.selectAll(".first-group-line").data(t).join(p=>p.append("line").attr("class",(d,i)=>["first-group-line",`element-${i}`].join(" ")).attr("stroke",d=>d.data.children.length?lt:null).attr("stroke-width",nt).attr("x1",$*1.5).attr("y1",(d,i)=>i*k).attr("x2",()=>n.isMobile?o.value*.9:o.value*.4).attr("y2",(d,i)=>i*k)),e(t,Vt,qt),r(mt,xt)}function Ut(t,e,r){x.value.selectAll(".first-group-element").data(t).join(p=>p.append("g").attr("class",(d,i)=>["first-group-element",`element-${i}`].join(" ")).attr("transform",`translate(0, -${k*2})`).each(function(d,i){if(d.type==="sdg"){const u=a.homeMapGraph.sdgs.find(V=>V.id===d.data.id),w=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");w.append("circle").attr("data-id",V=>V.id).attr("cx",y*1.1).attr("cy",0).attr("r",y).attr("stroke",b).attr("fill",b),w.append("text").attr("class","sdg-group-id").attr("x",$*1.5).attr("y",0).text(V=>`SDG ${V.data.id}`).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor","start"),w.append("rect").attr("x",$*1.5).attr("y",0).attr("fill",V=>V.data.color).attr("opacity",.4).attr("width",u.labelBbox.width).attr("height",u.labelBbox.height),w.append("text").text(V=>V.data.name).attr("x",$*1.5).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor","start")}else{const u=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");u.append("circle").attr("data-id",w=>w.id).attr("cx",y*1.1).attr("cy",0).attr("r",y).attr("stroke",b).attr("fill",b),u.append("text").attr("class","field-group-name").attr("x",$*1.5).attr("y",0).text(w=>w.data.name).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline",()=>d.data.children.length?"text-after-edge":"middle").attr("text-anchor","start")}const f=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("transform",`translate(${n.isMobile?o.value*.9:o.value*.4},0)`).attr("cursor","pointer");d.data.children.length&&(f.append("circle").attr("r",y*1.4).attr("stroke",b).attr("fill",b),f.append("text").text(u=>u.data.children.length).attr("fill","#f7f7f7").style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","middle"))})),x.value.selectAll(".first-group-element").transition().duration(J).ease(Q).attr("transform",(p,d)=>`translate(0, ${d*k})`),e(),r()}function m(t){return t==="mouseover"?At:b}function X(t){return t==="mouseover"?At:lt}function Z(t){return t==="mouseover"?"2.5px":nt}function et(t){return t==="mouseover"?"bold":"regular"}function Vt(){x.value.selectAll(".group-element").on("mouseover mouseout",function(t){const e=s.select(this).attr("data-index");a.detailsMapGraph.children[e].data.children.length&&s.selectAll(`line.element-${e}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),s.selectAll(`.connection-line-${e}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),e===C.value&&s.selectAll(".shown-work-rect").attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(`.element-${e} circle`).attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(`.element-${e} .sdg-group-id`).attr("fill",m(t.type)).attr("font-weight",et(t.type)),s.selectAll(`.element-${e} .field-group-name`).attr("fill",m(t.type)).attr("font-weight",et(t.type))})}const C=W(null),U=W([]),R=W([]);$t(()=>C.value,()=>{a.detailsMapGraph.type==="works"?ht(mt,xt):vt(kt,yt)});function qt(){x.value.selectAll(".group-element").on("click",function(){const t=s.select(this).attr("data-index");if(a.detailsMapGraph.children[t].data.children.length?C.value=t:C.value=null,a.detailsMapGraph.children[t].data.children.length){const e=a.detailsMapGraph.children[t].data.children;U.value=e}else U.value=[]})}function Kt(){x.value.selectAll(".group-element").on("click",function(){const t=s.select(this).attr("data-index");if(a.detailsMapGraph.children[t].children.length?C.value=t:C.value=null,a.detailsMapGraph.children[t].children.length){const e=a.detailsMapGraph.children[t].children;R.value=e}else R.value=[]})}function ht(t,e){const r=v.value.selectAll(".shown-work").data(U.value,function(f){return f}),p=r.enter().append("g").attr("class","shown-work").attr("transform",`translate(0, -${G*2})`);p.append("rect").attr("class","shown-work-rect").attr("data-id",(f,u)=>u),p.append("text").attr("class","shown-work-title").text(f=>f.title),p.append("rect").attr("class","shown-work-overlay").data(U.value,function(f,u){return u});const d=p.merge(r);d.select(".shown-work-title").text(f=>f.title),d.select(".shown-work-overlay title").text(f=>f.title),r.exit().remove(),v.value.selectAll(".shown-work-rect,.shown-work-overlay").attr("width",()=>n.isMobile?o.value*.9:o.value*.5).attr("height",l.sizes.worksBandwidth),v.value.selectAll(".shown-work-rect").attr("stroke",b).attr("fill",b),v.value.selectAll(".shown-work-overlay").attr("class","shown-work-overlay").attr("data-id",(f,u)=>u).attr("fill-opacity",0).attr("cursor","pointer"),v.value.selectAll(".shown-work-title").attr("x",5).attr("y",l.sizes.worksBandwidth*.85).style("font-size",l.sizes.workTitle).attr("fill","#f7f7f7"),v.value.selectAll(".shown-work").transition().duration(J).ease(Q).attr("transform",(f,u)=>`translate(0, ${G*u})`),t(),e(Xt)}function Qt(t){const e=n.isMobile?o.value*.9+y*1.5:o.value*.4+y*1.5,r=t*k,p=n.isMobile?o.value*.96:o.value*.4+y*4,d=n.isMobile?o.value*.96:o.value*.4+y*8,i=n.isMobile?a.detailsMapGraph.children.length*k+(U.value.length-1)*.5*G+l.sizes.worksBandwidth*.5:l.sizes.worksBandwidth*.5,f=n.isMobile?o.value*.92:o.value*.495,u=n.isMobile?a.detailsMapGraph.children.length*k+(U.value.length-1)*.5*G+l.sizes.worksBandwidth*.5:(U.value.length-1)*.5*G+l.sizes.worksBandwidth*.5;return[[{x:e,y:r},{x:p,y:r},{x:d,y:i},{x:f,y:u}]]}function ft(t){return s.line().x(r=>r.x).y(r=>r.y).curve(s.curveCatmullRom.alpha(.5))(t)}function mt(){const t=C.value?Qt(C.value):[];s.selectAll(".connection-line").remove(),x.value.selectAll(".connection-line").data(t).join(e=>e.append("path").attr("class",["connection-line",`connection-line-${C.value}`].join(" ")).attr("d",r=>ft(r)).attr("stroke","white").attr("fill","none").attr("stroke-width",nt),e=>e,e=>e),x.value.selectAll(".connection-line").transition().duration(J*.3).attr("stroke",lt)}const at=W(null);function wt(t){at.value.select(".tooltip-title").text(t.title),at.value.select(".tooltip-citation").text(`${t.year}${t.source.name?`: ${t.source.name}`:""}`)}function gt(t,e){at.value.style("visibility",t==="mouseover"?"visible":"hidden"),at.value.style("width",`${o.value}px`).style("left",`${(n.width-n.modalWidth)/2}px`).style("top",`${e.top-85}px`)}function xt(t){v.value.selectAll(".shown-work-overlay").on("mouseover mouseout",function(e,r){const p=C.value,d=s.select(this).attr("data-id");s.select(`.shown-work-rect[data-id='${d}']`).attr("stroke",m(e.type)).attr("fill",m(e.type)),s.selectAll(`line.element-${p}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.connection-line-${p}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.element-${p} circle`).attr("stroke",m(e.type)).attr("fill",m(e.type)),s.selectAll(`.element-${p} .sdg-group-id`).attr("fill",m(e.type)).attr("font-weight",et(e.type)),s.selectAll(`.element-${p} .field-group-name`).attr("fill",m(e.type)).attr("font-weight",et(e.type)),wt(r),gt(e.type,this.getBoundingClientRect())}),t()}function Xt(){v.value.selectAll(".shown-work-overlay").on("click",async function(){at.value.style("visibility","hidden");const t=s.select(this).attr("data-id"),e={type:"works",root:U.value[t],sizes:l.sizes},r=await Ct(e);a.setDetailsMapGraph(r),U.value=[],C.value=null,B(),h()})}function Zt(t,e,r){e(t,Jt,Kt),x.value.selectAll(".first-group-line").data(t).join(p=>p.append("line").attr("class",(d,i)=>["first-group-line",`element-${i}`].join(" ")).attr("stroke",d=>d.children.length?lt:null).attr("stroke-width",nt).attr("x1",n.isMobile?o.value*.75:o.value*.45).attr("y1",(d,i)=>i*G+l.sizes.worksBandwidth*.5).attr("x2",n.isMobile?o.value*.9-y*1.5*2:o.value*.5-y*1.5).attr("y2",(d,i)=>i*G+l.sizes.worksBandwidth*.5)),r(kt,yt)}function Yt(t,e,r){x.value.selectAll(".first-group-element").data(t).join(p=>p.append("g").attr("class",(d,i)=>["first-group-element",`element-${i}`].join(" ")).attr("transform",`translate(0, -${G*2})`).each(function(d,i){const f=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i);f.append("rect").attr("class","first-group-work-rect").attr("data-id",i),f.append("text").attr("class","first-group-work-title").attr("data-id",w=>w.id).text(w=>w.title),f.append("rect").attr("class","first-group-work-overlay");const u=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("transform",`translate(${n.isMobile?o.value*.9-y*1.5:o.value*.5},${l.sizes.worksBandwidth*.5})`).attr("cursor","pointer");d.children.length&&(u.append("circle").attr("class","first-group-work-circle").attr("r",y*1.4).attr("stroke",b).attr("fill",b),u.append("text").text(w=>w.children.length).attr("fill","#f7f7f7").style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","middle"))})),x.value.selectAll(".first-group-work-rect,.first-group-work-overlay").attr("width",()=>n.isMobile?o.value*.75:o.value*.45).attr("height",l.sizes.worksBandwidth),x.value.selectAll(".first-group-work-rect").attr("stroke",b).attr("fill",b),x.value.selectAll(".first-group-work-overlay").attr("fill-opacity",0).attr("cursor","pointer"),x.value.selectAll(".first-group-work-title").attr("x",5).attr("y",l.sizes.worksBandwidth*.85).style("font-size",l.sizes.workTitle).attr("fill","white"),x.value.selectAll(".first-group-element").transition().duration(J).ease(Q).attr("transform",(p,d)=>`translate(0, ${G*d})`),e(),r()}function Jt(){x.value.selectAll(".group-element").on("mouseover mouseout",function(t,e){const r=s.select(this).attr("data-index");a.detailsMapGraph.children[r].children.length&&s.selectAll(`line.element-${r}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),s.selectAll(`.connection-line-${r}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),r===C.value&&(s.selectAll(".shown-element-circle").attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(".shown-sdg-group-id, .shown-field-group-name").attr("fill",m(t.type)).attr("font-weight",et(t.type))),s.selectAll(`.element-${r} .first-group-work-circle`).attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(`.element-${r} .first-group-work-rect`).attr("stroke",m(t.type)).attr("fill",m(t.type)),wt(e),gt(t.type,this.getBoundingClientRect())})}function vt(t,e){s.selectAll(".shown-element").remove(),v.value.selectAll(".shown-element").data(R.value,function(d){return d}).enter().append("g").attr("class","shown-element").attr("data-id",(d,i)=>i).attr("transform",`translate(${n.isMobile?o.value*.85:o.value*.15}, -${k*2})`).each(function(d,i){if(d.type==="sdg"){const f=a.homeMapGraph.sdgs.find(w=>w.id===d.data.id),u=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");u.append("circle").attr("class","shown-element-circle").attr("data-id",w=>w.id).attr("r",y).attr("stroke",b).attr("fill",b),u.append("text").attr("class","shown-sdg-group-id").text(w=>`SDG ${w.data.id}`).attr("x",()=>n.isMobile?-$:$).attr("y",0).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor",()=>n.isMobile?"end":"start"),u.append("rect").attr("x",n.isMobile?-(f.labelBbox.width+$):$).attr("y",0).attr("fill",w=>w.data.color).attr("opacity",.4).attr("width",f.labelBbox.width).attr("height",f.labelBbox.height),u.append("text").text(w=>w.data.name).attr("x",()=>n.isMobile?-$:$).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor",()=>n.isMobile?"end":"start")}else{const f=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");f.append("circle").attr("class","shown-element-circle").attr("data-id",u=>u.id).attr("r",y).attr("stroke",b).attr("fill",b),f.append("text").attr("class","shown-field-group-name").text(u=>u.data.name).attr("x",()=>n.isMobile?-$:$).attr("y",0).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor",()=>n.isMobile?"end":"start")}}),v.value.selectAll(".shown-element").transition().duration(J).ease(Q).attr("transform",(d,i)=>`translate(${n.isMobile?o.value*.9-y*1.5:o.value*.15}, ${k*i})`),t(),e(ee)}function te(t){const e=n.isMobile?o.value*.9:y*1.5,r=t*G+l.sizes.worksBandwidth*.5,p=n.isMobile?o.value*.95:o.value*.1,d=n.isMobile?o.value*.95:o.value*.1,i=n.isMobile?a.detailsMapGraph.children.length*G+R.value.length*.5*k+k*.25:(R.value.length-1)*.5*k,f=n.isMobile?o.value*.9:o.value*.14,u=n.isMobile?a.detailsMapGraph.children.length*G+R.value.length*.5*k+k*.25:(R.value.length-1)*.5*k;return[[{x:e,y:r},{x:p,y:r},{x:d,y:i},{x:f,y:u}]]}function kt(){const t=C.value?te(C.value):[],e=n.isMobile?x.value:v.value;s.selectAll(".connection-line").remove(),e.selectAll(".connection-line").data(t).join(r=>r.append("path").attr("class",["connection-line",`connection-line-${C.value}`].join(" ")).attr("d",p=>ft(p)).attr("stroke","white").attr("fill","none").attr("stroke-width",nt),r=>r,r=>r),e.selectAll(".connection-line").transition().duration(J*.3).attr("stroke",lt)}function yt(t){v.value.selectAll(".shown-element").on("mouseover mouseout",function(e){const r=C.value;s.select(this).select(".shown-element-circle").attr("stroke",m(e.type)).attr("fill",m(e.type)),s.select(this).select(".shown-sdg-group-id, .shown-field-group-name").attr("fill",m(e.type)).attr("font-weight",et(e.type)),s.selectAll(`line.element-${r}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.connection-line-${r}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.element-${r} .first-group-work-circle`).attr("stroke",m(e.type)).attr("fill",m(e.type)),s.selectAll(`.element-${r} .first-group-work-rect`).attr("stroke",m(e.type)).attr("fill",m(e.type))}),t()}function ee(){v.value.selectAll(".shown-element").on("click",async function(){const t=s.select(this).attr("data-id");let e=R.value[t].data;if(R.value[t].type==="sdg"){const d=a.homeMapGraph.sdgs.find(i=>i.id===e.id);e.labelBbox=d.labelBbox}const r={type:`${R.value[t].type}s`,root:e,sizes:l.sizes},p=await Ct(r);a.setDetailsMapGraph(p),R.value=[],C.value=null,B(),h()})}const ae=q(()=>n.isMobile?22:25),dt=q(()=>_.papersInSpace.includes(a.detailsMapGraph.data.openAlexId)),re=q(()=>dt.value?"in Paper Space":"add to Paper Space");function le(){dt.value?_.removeFromPaperSpace(a.detailsMapGraph.data.openAlexId):_.addToPaperSpace(E,{query:g.searchQuery,...a.detailsMapGraph.data})}return(t,e)=>(tt(),st(Ee,null,[aa,j(a).detailsMapGraph.type==="works"?(tt(),st("div",{key:0,style:Ae({"font-size":l.sizes.workTitle})},[A("div",ra,[A("a",{href:j(a).detailsMapGraph.data.openAlexId,target:"_blank"},[A("div",null,it(j(a).detailsMapGraph.data.title),1)],8,la)]),A("div",na,[A("a",{href:j(a).detailsMapGraph.data.doi,target:"_blank"},it(j(a).detailsMapGraph.data.citation),9,sa)]),j(a).detailsMapGraph.data.abstract?(tt(),st("div",oa,[pt(j(Fe),null,{default:ut(()=>[pt(j(Ue),{title:"Abstract",name:"abstract"},{default:ut(()=>[A("div",null,it(j(a).detailsMapGraph.data.abstract),1)]),_:1})]),_:1})])):Gt("",!0),A("div",{class:"paper-space-controls",onClick:le},[pt(j(Se),{size:ae.value},{default:ut(()=>[dt.value?(tt(),_t(j(ea),{key:0})):(tt(),_t(j(Ze),{key:1}))]),_:1},8,["size"]),A("span",null,it(re.value),1)])],4)):Gt("",!0),ia],64))}},fa=Me(da,[["__scopeId","data-v-0574b0d1"]]);export{fa as default};
