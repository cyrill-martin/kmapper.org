import{d as n,a as Xt}from"./MapView-5f396cfd.js";import{x as lt,y as C,A as Jt,E as j,a2 as q,ap as z,a1 as ct,aq as Yt,a3 as te,H as At,h as L,i as J,a5 as ee,I as zt,U as ae,a7 as St,O as re,D as le,S as st,ar as se,M as Et,as as ne,at as oe,au as ie,av as de,aw as ce,G as pe,ax as ue,R as yt,ay as kt,ac as he,az as fe,_ as me,u as ge,d as we,f as xe,g as bt,o as Y,j as tt,l as D,a as W,aA as et,m as nt,k as Mt,w as $t,F as ve,q as ye,s as ke}from"./index-62baa71f.js";import{c as Gt}from"./DetailsMapContainer-6c96269e.js";const be=lt({name:"ChevronLeft",render(){return C("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),Me=lt({name:"ChevronRight",render(){return C("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C("path",{d:"M5.64645 3.14645C5.45118 3.34171 5.45118 3.65829 5.64645 3.85355L9.79289 8L5.64645 12.1464C5.45118 12.3417 5.45118 12.6583 5.64645 12.8536C5.84171 13.0488 6.15829 13.0488 6.35355 12.8536L10.8536 8.35355C11.0488 8.15829 11.0488 7.84171 10.8536 7.64645L6.35355 3.14645C6.15829 2.95118 5.84171 2.95118 5.64645 3.14645Z",fill:"currentColor"}))}}),$e=p=>{const{fontWeight:l,textColor1:s,textColor2:a,textColorDisabled:_,dividerColor:v,fontSize:E}=p;return{titleFontSize:E,titleFontWeight:l,dividerColor:v,titleTextColor:s,titleTextColorDisabled:_,fontSize:E,textColor:a,arrowColor:a,arrowColorDisabled:_,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},Ge={name:"Collapse",common:Jt,self:$e},Ce=Ge,_e=j("collapse","width: 100%;",[j("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[q("disabled",[z("header","cursor: not-allowed;",[z("header-main",`
 color: var(--n-title-text-color-disabled);
 `),j("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),j("collapse-item","margin-left: 32px;"),ct("&:first-child","margin-top: 0;"),ct("&:first-child >",[z("header","padding-top: 0;")]),q("left-arrow-placement",[z("header",[j("collapse-item-arrow","margin-right: 4px;")])]),q("right-arrow-placement",[z("header",[j("collapse-item-arrow","margin-left: 4px;")])]),z("content-wrapper",[z("content-inner","padding-top: 16px;"),Yt({duration:"0.15s"})]),q("active",[z("header",[q("active",[j("collapse-item-arrow","transform: rotate(90deg);")])])]),ct("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),te("disabled",[q("trigger-area-main",[z("header",[z("header-main","cursor: pointer;"),j("collapse-item-arrow","cursor: default;")])]),q("trigger-area-arrow",[z("header",[j("collapse-item-arrow","cursor: pointer;")])]),q("trigger-area-extra",[z("header",[z("header-extra","cursor: pointer;")])])]),z("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 `,[z("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),z("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),j("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),Ae=Object.assign(Object.assign({},zt.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},triggerAreas:{type:Array,default:()=>["main","extra","arrow"]},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),Bt=le("n-collapse"),ze=lt({name:"Collapse",props:Ae,setup(p,{slots:l}){const{mergedClsPrefixRef:s,inlineThemeDisabled:a,mergedRtlRef:_}=At(p),v=L(p.defaultExpandedNames),E=J(()=>p.expandedNames),N=ee(E,v),T=zt("Collapse","-collapse",_e,Ce,p,s);function B(A){const{"onUpdate:expandedNames":c,onUpdateExpandedNames:x,onExpandedNamesChange:S}=p;x&&st(x,A),c&&st(c,A),S&&st(S,A),v.value=A}function I(A){const{onItemHeaderClick:c}=p;c&&st(c,A)}function m(A,c,x){const{accordion:S}=p,{value:b}=N;if(S)A?(B([c]),I({name:c,expanded:!0,event:x})):(B([]),I({name:c,expanded:!1,event:x}));else if(!Array.isArray(b))B([c]),I({name:c,expanded:!0,event:x});else{const y=b.slice(),k=y.findIndex(M=>c===M);~k?(y.splice(k,1),B(y),I({name:c,expanded:!1,event:x})):(y.push(c),B(y),I({name:c,expanded:!0,event:x}))}}ae(Bt,{props:p,mergedClsPrefixRef:s,expandedNamesRef:N,slots:l,toggleItem:m});const o=St("Collapse",_,s),Z=J(()=>{const{common:{cubicBezierEaseInOut:A},self:{titleFontWeight:c,dividerColor:x,titlePadding:S,titleTextColor:b,titleTextColorDisabled:y,textColor:k,arrowColor:M,fontSize:O,titleFontSize:ot,arrowColorDisabled:it,itemMargin:dt}}=T.value;return{"--n-font-size":O,"--n-bezier":A,"--n-text-color":k,"--n-divider-color":x,"--n-title-padding":S,"--n-title-font-size":ot,"--n-title-text-color":b,"--n-title-text-color-disabled":y,"--n-title-font-weight":c,"--n-arrow-color":M,"--n-arrow-color-disabled":it,"--n-item-margin":dt}}),H=a?re("collapse",void 0,Z,p):void 0;return{rtlEnabled:o,mergedTheme:T,mergedClsPrefix:s,cssVars:a?void 0:Z,themeClass:H==null?void 0:H.themeClass,onRender:H==null?void 0:H.onRender}},render(){var p;return(p=this.onRender)===null||p===void 0||p.call(this),C("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),Se=lt({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(p){return{onceTrue:se(Et(p,"show"))}},render(){return C(ie,null,{default:()=>{const{show:p,displayDirective:l,onceTrue:s,clsPrefix:a}=this,_=l==="show"&&s,v=C("div",{class:`${a}-collapse-item__content-wrapper`},C("div",{class:`${a}-collapse-item__content-inner`},this.$slots));return _?ne(v,[[oe,p]]):p?v:null}})}}),Ee={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Be=lt({name:"CollapseItem",props:Ee,setup(p){const{mergedRtlRef:l}=At(p),s=de(),a=ce(()=>{var m;return(m=p.name)!==null&&m!==void 0?m:s}),_=pe(Bt);_||ue("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:v,props:E,mergedClsPrefixRef:N,slots:T}=_,B=J(()=>{const{value:m}=v;if(Array.isArray(m)){const{value:o}=a;return!~m.findIndex(Z=>Z===o)}else if(m){const{value:o}=a;return o!==m}return!0});return{rtlEnabled:St("Collapse",l,N),collapseSlots:T,randomName:s,mergedClsPrefix:N,collapsed:B,triggerAreas:Et(E,"triggerAreas"),mergedDisplayDirective:J(()=>{const{displayDirective:m}=p;return m||E.displayDirective}),arrowPlacement:J(()=>E.arrowPlacement),handleClick(m){let o="main";yt(m,"arrow")&&(o="arrow"),yt(m,"extra")&&(o="extra"),E.triggerAreas.includes(o)&&_&&!p.disabled&&_.toggleItem(B.value,a.value,m)}}},render(){const{collapseSlots:p,$slots:l,arrowPlacement:s,collapsed:a,mergedDisplayDirective:_,mergedClsPrefix:v,disabled:E,triggerAreas:N}=this,T=kt(l.header,{collapsed:a},()=>[this.title]),B=l["header-extra"]||p["header-extra"],I=l.arrow||p.arrow;return C("div",{class:[`${v}-collapse-item`,`${v}-collapse-item--${s}-arrow-placement`,E&&`${v}-collapse-item--disabled`,!a&&`${v}-collapse-item--active`,N.map(m=>`${v}-collapse-item--trigger-area-${m}`)]},C("div",{class:[`${v}-collapse-item__header`,!a&&`${v}-collapse-item__header--active`]},C("div",{class:`${v}-collapse-item__header-main`,onClick:this.handleClick},s==="right"&&T,C("div",{class:`${v}-collapse-item-arrow`,key:this.rtlEnabled?0:1,"data-arrow":!0},kt(I,{collapsed:a},()=>{var m;return[C(he,{clsPrefix:v},{default:(m=p.expandIcon)!==null&&m!==void 0?m:()=>this.rtlEnabled?C(be,null):C(Me,null)})]})),s==="left"&&T),fe(B,{collapsed:a},m=>C("div",{class:`${v}-collapse-item__header-extra`,onClick:this.handleClick,"data-extra":!0},m))),C(Se,{clsPrefix:v,displayDirective:_,show:!a},l))}});const It=p=>(ye("data-v-3bace406"),p=p(),ke(),p),Ie=It(()=>W("div",{id:"details-tooltip"},[W("div",{class:"tooltip-title"}),W("div",{class:"tooltip-citation"})],-1)),De={key:0},Ne={class:"details-work-title"},Te=["href"],Re={class:"details-work-citation"},Le=["href"],We={key:0},je={key:1},Pe={key:0,class:"details-work-abstract"},Fe=It(()=>W("div",{id:"details-map"},null,-1)),Ct=0,$="#333447",_t="#514efd",at="lightgrey",rt="1.5px",K=1e3,He={__name:"DetailsMap",props:["sizes"],setup(p){const l=p,s=ge(),a=we();xe(()=>{_(),N(),T(),X.value=n.select("#details-tooltip")});function _(){const t=n.select("#details-map");o.value=t.style("width").replace("px","")}const v=Xt(()=>{E()},500);bt(()=>s.width,()=>{v()});function E(){_(),N(),T()}function N(){n.select("#svg-details-chart").remove(),Z(),H()}function T(){Nt(),Lt()}const B=L(null),I=L(null),m=J(()=>{const t=a.detailsMapGraph.children.length;let e=n.max(a.detailsMapGraph.children.map(i=>a.detailsMapGraph.type==="works"?i.data.children.length:i.children.length));e=e||2;const r=a.detailsMapGraph.type==="works"?b:y,u=a.detailsMapGraph.type==="works"?y:b;let d=null;return a.detailsMapGraph.type==="works"?d=t>=e?S+t*r:S+e*u:d=t>e?S+t*r:S+e*u,s.isMobile?S+r*a.detailsMapGraph.children.length+e*u:d}),o=L(null);function Z(){B.value=n.select("#details-map").append("svg").attr("id","svg-details-chart").attr("viewBox",`0 0 ${o.value} ${m.value}`),I.value=B.value.append("g").attr("id","details-chart-container").attr("transform",`translate(${Ct}, ${Ct})`)}function H(){it(),dt(),Dt()}const A=L(null),c=L(null),x=L(null),S=l.sizes.worksBandwidth*5,b=l.sizes.worksBandwidth*3,y=l.sizes.worksBandwidth*1.5,k=l.sizes.worksBandwidth*.5,M=l.sizes.worksBandwidth*.5*2,O=n.easeElasticOut.amplitude(1).period(.4);function ot(){if(s.isMobile){let t=a.detailsMapGraph.children.length;const e=a.detailsMapGraph.type==="works"?b:y,r=a.detailsMapGraph.type==="works"?t*e:t*e+y*1.5;return`translate(0, ${S+r})`}else return`translate(${o.value*.5}, ${S})`}function it(){A.value=I.value.append("g").attr("transform","translate(0, 0)")}function dt(){c.value=I.value.append("g").attr("transform",`translate(0, ${S})`)}function Dt(){x.value=I.value.append("g").attr("transform",ot())}function Nt(){a.detailsMapGraph.type==="works"||(a.detailsMapGraph.type==="sdgs"?Tt():Rt())}function Tt(){const r=A.value.append("g").attr("class","title-group").attr("transform",`translate(0,-${l.sizes.worksBandwidth*4})`).append("a").attr("xlink:href",a.detailsMapGraph.data.url).attr("target","_blank").append("g").attr("transform",`translate(${l.sizes.worksBandwidth}, ${l.sizes.worksBandwidth})`);r.append("circle").attr("r",k).attr("stroke",$).attr("fill",$),r.append("text").text(`SDG ${a.detailsMapGraph.data.id}`).attr("x",M).attr("y",0).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor","start"),r.append("rect").attr("x",M).attr("y",0).attr("fill",a.detailsMapGraph.data.color).attr("opacity",.4).attr("width",a.detailsMapGraph.data.labelBbox.width).attr("height",a.detailsMapGraph.data.labelBbox.height),r.append("text").text(a.detailsMapGraph.data.name).attr("x",M).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor","start"),A.value.select(".title-group").transition().duration(K).ease(O).attr("transform","translate(0,0)")}function Rt(){const r=A.value.append("g").attr("class","title-group").attr("transform",`translate(0,-${l.sizes.worksBandwidth*4})`).append("a").attr("xlink:href",a.detailsMapGraph.data.url).attr("target","_blank").append("g").attr("transform",`translate(${l.sizes.worksBandwidth}, ${l.sizes.worksBandwidth})`);r.append("circle").attr("r",k).attr("stroke",$).attr("fill",$),r.append("text").text(a.detailsMapGraph.data.name).attr("x",M).attr("y",0).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","start"),A.value.select(".title-group").transition().duration(K).ease(O).attr("transform","translate(0,0)")}function Lt(){a.detailsMapGraph.type==="works"?Wt(a.detailsMapGraph.children,jt,pt):Vt(a.detailsMapGraph.children,qt,wt)}function Wt(t,e,r){c.value.selectAll(".first-group-line").data(t).join(u=>u.append("line").attr("class",(d,i)=>["first-group-line",`element-${i}`].join(" ")).attr("stroke",d=>d.data.children.length?at:null).attr("stroke-width",rt).attr("x1",M*1.5).attr("y1",(d,i)=>i*b).attr("x2",()=>s.isMobile?o.value*.9:o.value*.4).attr("y2",(d,i)=>i*b)),e(t,Pt,Ft),r(ht,gt)}function jt(t,e,r){c.value.selectAll(".first-group-element").data(t).join(u=>u.append("g").attr("class",(d,i)=>["first-group-element",`element-${i}`].join(" ")).attr("transform",`translate(0, -${b*2})`).each(function(d,i){if(d.type==="sdg"){const h=a.homeMapGraph.sdgs.find(F=>F.id===d.data.id),w=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");w.append("circle").attr("data-id",F=>F.id).attr("cx",k*1.1).attr("cy",0).attr("r",k).attr("stroke",$).attr("fill",$),w.append("text").attr("class","sdg-group-id").attr("x",M*1.5).attr("y",0).text(F=>`SDG ${F.data.id}`).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor","start"),w.append("rect").attr("x",M*1.5).attr("y",0).attr("fill",F=>F.data.color).attr("opacity",.4).attr("width",h.labelBbox.width).attr("height",h.labelBbox.height),w.append("text").text(F=>F.data.name).attr("x",M*1.5).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor","start")}else{const h=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");h.append("circle").attr("data-id",w=>w.id).attr("cx",k*1.1).attr("cy",0).attr("r",k).attr("stroke",$).attr("fill",$),h.append("text").attr("class","field-group-name").attr("x",M*1.5).attr("y",0).text(w=>w.data.name).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline",()=>d.data.children.length?"text-after-edge":"middle").attr("text-anchor","start")}const f=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("transform",`translate(${s.isMobile?o.value*.9:o.value*.4},0)`).attr("cursor","pointer");d.data.children.length&&(f.append("circle").attr("r",k*1.4).attr("stroke",$).attr("fill",$),f.append("text").text(h=>h.data.children.length).attr("fill","#f7f7f7").style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","middle"))})),c.value.selectAll(".first-group-element").transition().duration(K).ease(O).attr("transform",(u,d)=>`translate(0, ${d*b})`),e(),r()}function g(t){return t==="mouseover"?_t:$}function U(t){return t==="mouseover"?_t:at}function V(t){return t==="mouseover"?"2.5px":rt}function Q(t){return t==="mouseover"?"bold":"regular"}function Pt(){c.value.selectAll(".group-element").on("mouseover mouseout",function(t){const e=n.select(this).attr("data-index");a.detailsMapGraph.children[e].data.children.length&&n.selectAll(`line.element-${e}`).attr("stroke",U(t.type)).attr("stroke-width",V(t.type)),n.selectAll(`.connection-line-${e}`).attr("stroke",U(t.type)).attr("stroke-width",V(t.type)),e===G.value&&n.selectAll(".shown-work-rect").attr("stroke",g(t.type)).attr("fill",g(t.type)),n.selectAll(`.element-${e} circle`).attr("stroke",g(t.type)).attr("fill",g(t.type)),n.selectAll(`.element-${e} .sdg-group-id`).attr("fill",g(t.type)).attr("font-weight",Q(t.type)),n.selectAll(`.element-${e} .field-group-name`).attr("fill",g(t.type)).attr("font-weight",Q(t.type))})}const G=L(null),P=L([]),R=L([]);bt(()=>G.value,()=>{a.detailsMapGraph.type==="works"?pt(ht,gt):wt(xt,vt)});function Ft(){c.value.selectAll(".group-element").on("click",function(){const t=n.select(this).attr("data-index");if(a.detailsMapGraph.children[t].data.children.length?G.value=t:G.value=null,a.detailsMapGraph.children[t].data.children.length){const e=a.detailsMapGraph.children[t].data.children;P.value=e}else P.value=[]})}function Ht(){c.value.selectAll(".group-element").on("click",function(){const t=n.select(this).attr("data-index");if(a.detailsMapGraph.children[t].children.length?G.value=t:G.value=null,a.detailsMapGraph.children[t].children.length){const e=a.detailsMapGraph.children[t].children;R.value=e}else R.value=[]})}function pt(t,e){const r=x.value.selectAll(".shown-work").data(P.value,function(f){return f}),u=r.enter().append("g").attr("class","shown-work").attr("transform",`translate(0, -${y*2})`);u.append("rect").attr("class","shown-work-rect").attr("data-id",(f,h)=>h),u.append("text").attr("class","shown-work-title").text(f=>f.title),u.append("rect").attr("class","shown-work-overlay").data(P.value,function(f,h){return h});const d=u.merge(r);d.select(".shown-work-title").text(f=>f.title),d.select(".shown-work-overlay title").text(f=>f.title),r.exit().remove(),x.value.selectAll(".shown-work-rect,.shown-work-overlay").attr("width",()=>s.isMobile?o.value*.9:o.value*.5).attr("height",l.sizes.worksBandwidth),x.value.selectAll(".shown-work-rect").attr("stroke",$).attr("fill",$),x.value.selectAll(".shown-work-overlay").attr("class","shown-work-overlay").attr("data-id",(f,h)=>h).attr("fill-opacity",0).attr("cursor","pointer"),x.value.selectAll(".shown-work-title").attr("x",5).attr("y",l.sizes.worksBandwidth*.85).style("font-size",l.sizes.workTitle).attr("fill","#f7f7f7"),x.value.selectAll(".shown-work").transition().duration(K).ease(O).attr("transform",(f,h)=>`translate(0, ${y*h})`),t(),e(Ut)}function Ot(t){const e=s.isMobile?o.value*.9+k*1.5:o.value*.4+k*1.5,r=t*b,u=s.isMobile?o.value*.96:o.value*.4+k*4,d=s.isMobile?o.value*.96:o.value*.4+k*8,i=s.isMobile?a.detailsMapGraph.children.length*b+(P.value.length-1)*.5*y+l.sizes.worksBandwidth*.5:l.sizes.worksBandwidth*.5,f=s.isMobile?o.value*.92:o.value*.495,h=s.isMobile?a.detailsMapGraph.children.length*b+(P.value.length-1)*.5*y+l.sizes.worksBandwidth*.5:(P.value.length-1)*.5*y+l.sizes.worksBandwidth*.5;return[[{x:e,y:r},{x:u,y:r},{x:d,y:i},{x:f,y:h}]]}function ut(t){return n.line().x(r=>r.x).y(r=>r.y).curve(n.curveCatmullRom.alpha(.5))(t)}function ht(){const t=G.value?Ot(G.value):[];n.selectAll(".connection-line").remove(),c.value.selectAll(".connection-line").data(t).join(e=>e.append("path").attr("class",["connection-line",`connection-line-${G.value}`].join(" ")).attr("d",r=>ut(r)).attr("stroke","white").attr("fill","none").attr("stroke-width",rt),e=>e,e=>e),c.value.selectAll(".connection-line").transition().duration(K*.3).attr("stroke",at)}const X=L(null);function ft(t){X.value.select(".tooltip-title").text(t.title),X.value.select(".tooltip-citation").text(`${t.year}${t.source.name?`: ${t.source.name}`:""}`)}function mt(t,e){X.value.style("visibility",t==="mouseover"?"visible":"hidden"),X.value.style("width",`${o.value}px`).style("left",`${(s.width-s.modalWidth)/2}px`).style("top",`${e.top-85}px`)}function gt(t){x.value.selectAll(".shown-work-overlay").on("mouseover mouseout",function(e,r){const u=G.value,d=n.select(this).attr("data-id");n.select(`.shown-work-rect[data-id='${d}']`).attr("stroke",g(e.type)).attr("fill",g(e.type)),n.selectAll(`line.element-${u}`).attr("stroke",U(e.type)).attr("stroke-width",V(e.type)),n.selectAll(`.connection-line-${u}`).attr("stroke",U(e.type)).attr("stroke-width",V(e.type)),n.selectAll(`.element-${u} circle`).attr("stroke",g(e.type)).attr("fill",g(e.type)),n.selectAll(`.element-${u} .sdg-group-id`).attr("fill",g(e.type)).attr("font-weight",Q(e.type)),n.selectAll(`.element-${u} .field-group-name`).attr("fill",g(e.type)).attr("font-weight",Q(e.type)),ft(r),mt(e.type,this.getBoundingClientRect())}),t()}function Ut(){x.value.selectAll(".shown-work-overlay").on("click",async function(){X.value.style("visibility","hidden");const t=n.select(this).attr("data-id"),e={type:"works",root:P.value[t],sizes:l.sizes},r=await Gt(e);a.setDetailsMapGraph(r),P.value=[],G.value=null,N(),T()})}function Vt(t,e,r){e(t,Kt,Ht),c.value.selectAll(".first-group-line").data(t).join(u=>u.append("line").attr("class",(d,i)=>["first-group-line",`element-${i}`].join(" ")).attr("stroke",d=>d.children.length?at:null).attr("stroke-width",rt).attr("x1",s.isMobile?o.value*.75:o.value*.45).attr("y1",(d,i)=>i*y+l.sizes.worksBandwidth*.5).attr("x2",s.isMobile?o.value*.9-k*1.5*2:o.value*.5-k*1.5).attr("y2",(d,i)=>i*y+l.sizes.worksBandwidth*.5)),r(xt,vt)}function qt(t,e,r){c.value.selectAll(".first-group-element").data(t).join(u=>u.append("g").attr("class",(d,i)=>["first-group-element",`element-${i}`].join(" ")).attr("transform",`translate(0, -${y*2})`).each(function(d,i){const f=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i);f.append("rect").attr("class","first-group-work-rect").attr("data-id",i),f.append("text").attr("class","first-group-work-title").attr("data-id",w=>w.id).text(w=>w.title),f.append("rect").attr("class","first-group-work-overlay");const h=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("transform",`translate(${s.isMobile?o.value*.9-k*1.5:o.value*.5},${l.sizes.worksBandwidth*.5})`).attr("cursor","pointer");d.children.length&&(h.append("circle").attr("class","first-group-work-circle").attr("r",k*1.4).attr("stroke",$).attr("fill",$),h.append("text").text(w=>w.children.length).attr("fill","#f7f7f7").style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","middle"))})),c.value.selectAll(".first-group-work-rect,.first-group-work-overlay").attr("width",()=>s.isMobile?o.value*.75:o.value*.45).attr("height",l.sizes.worksBandwidth),c.value.selectAll(".first-group-work-rect").attr("stroke",$).attr("fill",$),c.value.selectAll(".first-group-work-overlay").attr("fill-opacity",0).attr("cursor","pointer"),c.value.selectAll(".first-group-work-title").attr("x",5).attr("y",l.sizes.worksBandwidth*.85).style("font-size",l.sizes.workTitle).attr("fill","white"),c.value.selectAll(".first-group-element").transition().duration(K).ease(O).attr("transform",(u,d)=>`translate(0, ${y*d})`),e(),r()}function Kt(){c.value.selectAll(".group-element").on("mouseover mouseout",function(t,e){const r=n.select(this).attr("data-index");a.detailsMapGraph.children[r].children.length&&n.selectAll(`line.element-${r}`).attr("stroke",U(t.type)).attr("stroke-width",V(t.type)),n.selectAll(`.connection-line-${r}`).attr("stroke",U(t.type)).attr("stroke-width",V(t.type)),r===G.value&&(n.selectAll(".shown-element-circle").attr("stroke",g(t.type)).attr("fill",g(t.type)),n.selectAll(".shown-sdg-group-id, .shown-field-group-name").attr("fill",g(t.type)).attr("font-weight",Q(t.type))),n.selectAll(`.element-${r} .first-group-work-circle`).attr("stroke",g(t.type)).attr("fill",g(t.type)),n.selectAll(`.element-${r} .first-group-work-rect`).attr("stroke",g(t.type)).attr("fill",g(t.type)),ft(e),mt(t.type,this.getBoundingClientRect())})}function wt(t,e){n.selectAll(".shown-element").remove(),x.value.selectAll(".shown-element").data(R.value,function(d){return d}).enter().append("g").attr("class","shown-element").attr("data-id",(d,i)=>i).attr("transform",`translate(${s.isMobile?o.value*.85:o.value*.15}, -${b*2})`).each(function(d,i){if(d.type==="sdg"){const f=a.homeMapGraph.sdgs.find(w=>w.id===d.data.id),h=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");h.append("circle").attr("class","shown-element-circle").attr("data-id",w=>w.id).attr("r",k).attr("stroke",$).attr("fill",$),h.append("text").attr("class","shown-sdg-group-id").text(w=>`SDG ${w.data.id}`).attr("x",()=>s.isMobile?-M:M).attr("y",0).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor",()=>s.isMobile?"end":"start"),h.append("rect").attr("x",s.isMobile?-(f.labelBbox.width+M):M).attr("y",0).attr("fill",w=>w.data.color).attr("opacity",.4).attr("width",f.labelBbox.width).attr("height",f.labelBbox.height),h.append("text").text(w=>w.data.name).attr("x",()=>s.isMobile?-M:M).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor",()=>s.isMobile?"end":"start")}else{const f=n.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");f.append("circle").attr("class","shown-element-circle").attr("data-id",h=>h.id).attr("r",k).attr("stroke",$).attr("fill",$),f.append("text").attr("class","shown-field-group-name").text(h=>h.data.name).attr("x",()=>s.isMobile?-M:M).attr("y",0).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor",()=>s.isMobile?"end":"start")}}),x.value.selectAll(".shown-element").transition().duration(K).ease(O).attr("transform",(d,i)=>`translate(${s.isMobile?o.value*.9-k*1.5:o.value*.15}, ${b*i})`),t(),e(Qt)}function Zt(t){const e=s.isMobile?o.value*.9:k*1.5,r=t*y+l.sizes.worksBandwidth*.5,u=s.isMobile?o.value*.95:o.value*.1,d=s.isMobile?o.value*.95:o.value*.1,i=s.isMobile?a.detailsMapGraph.children.length*y+R.value.length*.5*b+b*.25:(R.value.length-1)*.5*b,f=s.isMobile?o.value*.9:o.value*.14,h=s.isMobile?a.detailsMapGraph.children.length*y+R.value.length*.5*b+b*.25:(R.value.length-1)*.5*b;return[[{x:e,y:r},{x:u,y:r},{x:d,y:i},{x:f,y:h}]]}function xt(){const t=G.value?Zt(G.value):[],e=s.isMobile?c.value:x.value;n.selectAll(".connection-line").remove(),e.selectAll(".connection-line").data(t).join(r=>r.append("path").attr("class",["connection-line",`connection-line-${G.value}`].join(" ")).attr("d",u=>ut(u)).attr("stroke","white").attr("fill","none").attr("stroke-width",rt),r=>r,r=>r),e.selectAll(".connection-line").transition().duration(K*.3).attr("stroke",at)}function vt(t){x.value.selectAll(".shown-element").on("mouseover mouseout",function(e){const r=G.value;n.select(this).select(".shown-element-circle").attr("stroke",g(e.type)).attr("fill",g(e.type)),n.select(this).select(".shown-sdg-group-id, .shown-field-group-name").attr("fill",g(e.type)).attr("font-weight",Q(e.type)),n.selectAll(`line.element-${r}`).attr("stroke",U(e.type)).attr("stroke-width",V(e.type)),n.selectAll(`.connection-line-${r}`).attr("stroke",U(e.type)).attr("stroke-width",V(e.type)),n.selectAll(`.element-${r} .first-group-work-circle`).attr("stroke",g(e.type)).attr("fill",g(e.type)),n.selectAll(`.element-${r} .first-group-work-rect`).attr("stroke",g(e.type)).attr("fill",g(e.type))}),t()}function Qt(){x.value.selectAll(".shown-element").on("click",async function(){const t=n.select(this).attr("data-id");let e=R.value[t].data;if(R.value[t].type==="sdg"){const d=a.homeMapGraph.sdgs.find(i=>i.id===e.id);e.labelBbox=d.labelBbox}const r={type:`${R.value[t].type}s`,root:e,sizes:l.sizes},u=await Gt(r);a.setDetailsMapGraph(u),R.value=[],G.value=null,N(),T()})}return(t,e)=>(Y(),tt(ve,null,[Ie,D(a).detailsMapGraph.type==="works"?(Y(),tt("div",De,[W("div",Ne,[W("a",{href:D(a).detailsMapGraph.data.openAlexId,target:"_blank"},[W("div",null,et(D(a).detailsMapGraph.data.title),1)],8,Te)]),W("div",Re,[W("a",{href:D(a).detailsMapGraph.data.doi,target:"_blank"},[W("span",null,et(D(a).detailsMapGraph.data.year),1),D(a).detailsMapGraph.data.source.name?(Y(),tt("span",We,": "+et(D(a).detailsMapGraph.data.source.name),1)):nt("",!0),D(a).detailsMapGraph.data.doi?(Y(),tt("span",je," - "+et(D(a).detailsMapGraph.data.doi),1)):nt("",!0)],8,Le)]),D(a).detailsMapGraph.data.abstract?(Y(),tt("div",Pe,[Mt(D(ze),null,{default:$t(()=>[Mt(D(Be),{title:"Abstract",name:"abstract"},{default:$t(()=>[W("div",null,et(D(a).detailsMapGraph.data.abstract),1)]),_:1})]),_:1})])):nt("",!0)])):nt("",!0),Fe],64))}},qe=me(He,[["__scopeId","data-v-3bace406"]]);export{qe as default};
