import{D as lt,E as S,G as ne,R as F,S as Y,U as z,Q as ut,bg as se,ad as oe,I as St,h as W,i as q,K as ie,$ as Et,L as de,a0 as Bt,a2 as ce,O as pe,P as it,bh as ue,M as It,bi as he,bj as fe,bk as me,a3 as we,Z as ge,Y as xe,bl as ve,ay as bt,bm as Mt,aj as ke,bn as ye,o as tt,j as rt,a as A,_ as be,u as Me,d as $e,aX as Ge,e as _e,f as Ce,g as $t,l as j,n as ze,bo as dt,k as ct,w as pt,m as Gt,ax as Ae,c as _t,av as Se,F as Ee,q as Be,s as Ie}from"./index-587d60a6.js";import{d as s,a as De}from"./MapView-457ceb43.js";import{c as Ct}from"./DetailsMapContainer-a8f8607f.js";import{C as Te,u as Ne}from"./composables-8d1af27a.js";const Pe=lt({name:"ChevronLeft",render(){return S("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},S("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),je=c=>{const{fontWeight:l,textColor1:n,textColor2:a,textColorDisabled:_,dividerColor:g,fontSize:E}=c;return{titleFontSize:E,titleFontWeight:l,dividerColor:g,titleTextColor:n,titleTextColorDisabled:_,fontSize:E,textColor:a,arrowColor:a,arrowColorDisabled:_,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},Re={name:"Collapse",common:ne,self:je},We=Re,Le=F("collapse","width: 100%;",[F("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[Y("disabled",[z("header","cursor: not-allowed;",[z("header-main",`
 color: var(--n-title-text-color-disabled);
 `),F("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),F("collapse-item","margin-left: 32px;"),ut("&:first-child","margin-top: 0;"),ut("&:first-child >",[z("header","padding-top: 0;")]),Y("left-arrow-placement",[z("header",[F("collapse-item-arrow","margin-right: 4px;")])]),Y("right-arrow-placement",[z("header",[F("collapse-item-arrow","margin-left: 4px;")])]),z("content-wrapper",[z("content-inner","padding-top: 16px;"),se({duration:"0.15s"})]),Y("active",[z("header",[Y("active",[F("collapse-item-arrow","transform: rotate(90deg);")])])]),ut("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),oe("disabled",[Y("trigger-area-main",[z("header",[z("header-main","cursor: pointer;"),F("collapse-item-arrow","cursor: default;")])]),Y("trigger-area-arrow",[z("header",[F("collapse-item-arrow","cursor: pointer;")])]),Y("trigger-area-extra",[z("header",[z("header-extra","cursor: pointer;")])])]),z("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 `,[z("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),z("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),F("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),Fe=Object.assign(Object.assign({},Et.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},triggerAreas:{type:Array,default:()=>["main","extra","arrow"]},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),Dt=pe("n-collapse"),Oe=lt({name:"Collapse",props:Fe,setup(c,{slots:l}){const{mergedClsPrefixRef:n,inlineThemeDisabled:a,mergedRtlRef:_}=St(c),g=W(c.defaultExpandedNames),E=q(()=>c.expandedNames),L=ie(E,g),O=Et("Collapse","-collapse",Le,We,c,n);function D(o){const{"onUpdate:expandedNames":M,onUpdateExpandedNames:N,onExpandedNamesChange:P}=c;N&&it(N,o),M&&it(M,o),P&&it(P,o),g.value=o}function B(o){const{onItemHeaderClick:M}=c;M&&it(M,o)}function h(o,M,N){const{accordion:P}=c,{value:x}=L;if(P)o?(D([M]),B({name:M,expanded:!0,event:N})):(D([]),B({name:M,expanded:!1,event:N}));else if(!Array.isArray(x))D([M]),B({name:M,expanded:!0,event:N});else{const v=x.slice(),I=v.findIndex(k=>M===k);~I?(v.splice(I,1),D(v),B({name:M,expanded:!1,event:N})):(v.push(M),D(v),B({name:M,expanded:!0,event:N}))}}de(Dt,{props:c,mergedClsPrefixRef:n,expandedNamesRef:L,slots:l,toggleItem:h});const T=Bt("Collapse",_,n),H=q(()=>{const{common:{cubicBezierEaseInOut:o},self:{titleFontWeight:M,dividerColor:N,titlePadding:P,titleTextColor:x,titleTextColorDisabled:v,textColor:I,arrowColor:k,fontSize:G,titleFontSize:y,arrowColorDisabled:$,itemMargin:Q}}=O.value;return{"--n-font-size":G,"--n-bezier":o,"--n-text-color":I,"--n-divider-color":N,"--n-title-padding":P,"--n-title-font-size":y,"--n-title-text-color":x,"--n-title-text-color-disabled":v,"--n-title-font-weight":M,"--n-arrow-color":k,"--n-arrow-color-disabled":$,"--n-item-margin":Q}}),K=a?ce("collapse",void 0,H,c):void 0;return{rtlEnabled:T,mergedTheme:O,mergedClsPrefix:n,cssVars:a?void 0:H,themeClass:K==null?void 0:K.themeClass,onRender:K==null?void 0:K.onRender}},render(){var c;return(c=this.onRender)===null||c===void 0||c.call(this),S("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),He=lt({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(c){return{onceTrue:ue(It(c,"show"))}},render(){return S(me,null,{default:()=>{const{show:c,displayDirective:l,onceTrue:n,clsPrefix:a}=this,_=l==="show"&&n,g=S("div",{class:`${a}-collapse-item__content-wrapper`},S("div",{class:`${a}-collapse-item__content-inner`},this.$slots));return _?he(g,[[fe,c]]):c?g:null}})}}),Ue={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Ve=lt({name:"CollapseItem",props:Ue,setup(c){const{mergedRtlRef:l}=St(c),n=we(),a=ge(()=>{var h;return(h=c.name)!==null&&h!==void 0?h:n}),_=xe(Dt);_||ve("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:g,props:E,mergedClsPrefixRef:L,slots:O}=_,D=q(()=>{const{value:h}=g;if(Array.isArray(h)){const{value:T}=a;return!~h.findIndex(H=>H===T)}else if(h){const{value:T}=a;return T!==h}return!0});return{rtlEnabled:Bt("Collapse",l,L),collapseSlots:O,randomName:n,mergedClsPrefix:L,collapsed:D,triggerAreas:It(E,"triggerAreas"),mergedDisplayDirective:q(()=>{const{displayDirective:h}=c;return h||E.displayDirective}),arrowPlacement:q(()=>E.arrowPlacement),handleClick(h){let T="main";bt(h,"arrow")&&(T="arrow"),bt(h,"extra")&&(T="extra"),E.triggerAreas.includes(T)&&_&&!c.disabled&&_.toggleItem(D.value,a.value,h)}}},render(){const{collapseSlots:c,$slots:l,arrowPlacement:n,collapsed:a,mergedDisplayDirective:_,mergedClsPrefix:g,disabled:E,triggerAreas:L}=this,O=Mt(l.header,{collapsed:a},()=>[this.title]),D=l["header-extra"]||c["header-extra"],B=l.arrow||c.arrow;return S("div",{class:[`${g}-collapse-item`,`${g}-collapse-item--${n}-arrow-placement`,E&&`${g}-collapse-item--disabled`,!a&&`${g}-collapse-item--active`,L.map(h=>`${g}-collapse-item--trigger-area-${h}`)]},S("div",{class:[`${g}-collapse-item__header`,!a&&`${g}-collapse-item__header--active`]},S("div",{class:`${g}-collapse-item__header-main`,onClick:this.handleClick},n==="right"&&O,S("div",{class:`${g}-collapse-item-arrow`,key:this.rtlEnabled?0:1,"data-arrow":!0},Mt(B,{collapsed:a},()=>{var h;return[S(ke,{clsPrefix:g},{default:(h=c.expandIcon)!==null&&h!==void 0?h:()=>this.rtlEnabled?S(Pe,null):S(Te,null)})]})),n==="left"&&O),ye(D,{collapsed:a},h=>S("div",{class:`${g}-collapse-item__header-extra`,onClick:this.handleClick,"data-extra":!0},h))),S(He,{clsPrefix:g,displayDirective:_,show:!a},l))}}),qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ke=A("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),Qe=A("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 176v160"},null,-1),Xe=A("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 256H176"},null,-1),Ze=[Ke,Qe,Xe],Ye=lt({name:"AddCircleOutline",render:function(l,n){return tt(),rt("svg",qe,Ze)}}),Je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ta=A("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M416 128L192 384l-96-96"},null,-1),ea=[ta],aa=lt({name:"Checkmark",render:function(l,n){return tt(),rt("svg",Je,ea)}});const Tt=c=>(Be("data-v-9e94458a"),c=c(),Ie(),c),ra=Tt(()=>A("div",{id:"details-tooltip"},[A("div",{class:"tooltip-title"}),A("div",{class:"tooltip-citation"})],-1)),la={class:"details-work-title"},na=["href"],sa={class:"details-work-citation"},oa=["href"],ia={key:0,class:"details-work-abstract"},da=Tt(()=>A("div",{id:"details-map"},null,-1)),zt=0,b="#333447",At="#514efd",nt="lightgrey",st="1.5px",J=1e3,ca={__name:"DetailsMap",props:["sizes"],setup(c){const l=c,n=Me(),a=$e(),_=Ge(),g=_e(),E=Ne();Ce(()=>{L(),B(),h(),et.value=s.select("#details-tooltip")});function L(){const t=s.select("#details-map");o.value=t.style("width").replace("px","")}const O=De(()=>{D()},500);$t(()=>n.width,()=>{O()});function D(){L(),B(),h()}function B(){s.select("#svg-details-chart").remove(),M(),N()}function h(){Wt(),Ot()}const T=W(null),H=W(null),K=q(()=>{const t=a.detailsMapGraph.children.length;let e=s.max(a.detailsMapGraph.children.map(i=>a.detailsMapGraph.type==="works"?i.data.children.length:i.children.length));e=e||2;const r=a.detailsMapGraph.type==="works"?k:G,p=a.detailsMapGraph.type==="works"?G:k;let d=null;return a.detailsMapGraph.type==="works"?d=t>=e?I+t*r:I+e*p:d=t>e?I+t*r:I+e*p,n.isMobile?I+r*a.detailsMapGraph.children.length+e*p:d}),o=W(null);function M(){T.value=s.select("#details-map").append("svg").attr("id","svg-details-chart").attr("viewBox",`0 0 ${o.value} ${K.value}`),H.value=T.value.append("g").attr("id","details-chart-container").attr("transform",`translate(${zt}, ${zt})`)}function N(){Pt(),jt(),Rt()}const P=W(null),x=W(null),v=W(null),I=l.sizes.worksBandwidth*5,k=l.sizes.worksBandwidth*3,G=l.sizes.worksBandwidth*1.5,y=l.sizes.worksBandwidth*.5,$=l.sizes.worksBandwidth*.5*2,Q=s.easeElasticOut.amplitude(1).period(.4);function Nt(){if(n.isMobile){let t=a.detailsMapGraph.children.length;const e=a.detailsMapGraph.type==="works"?k:G,r=a.detailsMapGraph.type==="works"?t*e:t*e+G*1.5;return`translate(0, ${I+r})`}else return`translate(${o.value*.5}, ${I})`}function Pt(){P.value=H.value.append("g").attr("transform","translate(0, 0)")}function jt(){x.value=H.value.append("g").attr("transform",`translate(0, ${I})`)}function Rt(){v.value=H.value.append("g").attr("transform",Nt())}function Wt(){a.detailsMapGraph.type==="works"||(a.detailsMapGraph.type==="sdgs"?Lt():Ft())}function Lt(){const r=P.value.append("g").attr("class","title-group").attr("transform",`translate(0,-${l.sizes.worksBandwidth*4})`).append("a").attr("xlink:href",a.detailsMapGraph.data.url).attr("target","_blank").append("g").attr("transform",`translate(${l.sizes.worksBandwidth}, ${l.sizes.worksBandwidth})`);r.append("circle").attr("r",y).attr("stroke",b).attr("fill",b),r.append("text").text(`SDG ${a.detailsMapGraph.data.id}`).attr("x",$).attr("y",0).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor","start"),r.append("rect").attr("x",$).attr("y",0).attr("fill",a.detailsMapGraph.data.color).attr("opacity",.4).attr("width",a.detailsMapGraph.data.labelBbox.width).attr("height",a.detailsMapGraph.data.labelBbox.height),r.append("text").text(a.detailsMapGraph.data.name).attr("x",$).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor","start"),P.value.select(".title-group").transition().duration(J).ease(Q).attr("transform","translate(0,0)")}function Ft(){const r=P.value.append("g").attr("class","title-group").attr("transform",`translate(0,-${l.sizes.worksBandwidth*4})`).append("a").attr("xlink:href",a.detailsMapGraph.data.url).attr("target","_blank").append("g").attr("transform",`translate(${l.sizes.worksBandwidth}, ${l.sizes.worksBandwidth})`);r.append("circle").attr("r",y).attr("stroke",b).attr("fill",b),r.append("text").text(a.detailsMapGraph.data.name).attr("x",$).attr("y",0).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","start"),P.value.select(".title-group").transition().duration(J).ease(Q).attr("transform","translate(0,0)")}function Ot(){a.detailsMapGraph.type==="works"?Ht(a.detailsMapGraph.children,Ut,ht):Zt(a.detailsMapGraph.children,Yt,vt)}function Ht(t,e,r){x.value.selectAll(".first-group-line").data(t).join(p=>p.append("line").attr("class",(d,i)=>["first-group-line",`element-${i}`].join(" ")).attr("stroke",d=>d.data.children.length?nt:null).attr("stroke-width",st).attr("x1",$*1.5).attr("y1",(d,i)=>i*k).attr("x2",()=>n.isMobile?o.value*.9:o.value*.4).attr("y2",(d,i)=>i*k)),e(t,Vt,qt),r(mt,xt)}function Ut(t,e,r){x.value.selectAll(".first-group-element").data(t).join(p=>p.append("g").attr("class",(d,i)=>["first-group-element",`element-${i}`].join(" ")).attr("transform",`translate(0, -${k*2})`).each(function(d,i){if(d.type==="sdg"){const u=a.homeMapGraph.sdgs.find(V=>V.id===d.data.id),w=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");w.append("circle").attr("data-id",V=>V.id).attr("cx",y*1.1).attr("cy",0).attr("r",y).attr("stroke",b).attr("fill",b),w.append("text").attr("class","sdg-group-id").attr("x",$*1.5).attr("y",0).text(V=>`SDG ${V.data.id}`).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor","start"),w.append("rect").attr("x",$*1.5).attr("y",0).attr("fill",V=>V.data.color).attr("opacity",.4).attr("width",u.labelBbox.width).attr("height",u.labelBbox.height),w.append("text").text(V=>V.data.name).attr("x",$*1.5).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor","start")}else{const u=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");u.append("circle").attr("data-id",w=>w.id).attr("cx",y*1.1).attr("cy",0).attr("r",y).attr("stroke",b).attr("fill",b),u.append("text").attr("class","field-group-name").attr("x",$*1.5).attr("y",0).text(w=>w.data.name).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline",()=>d.data.children.length?"text-after-edge":"middle").attr("text-anchor","start")}const f=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("transform",`translate(${n.isMobile?o.value*.9:o.value*.4},0)`).attr("cursor","pointer");d.data.children.length&&(f.append("circle").attr("r",y*1.4).attr("stroke",b).attr("fill",b),f.append("text").text(u=>u.data.children.length).attr("fill","#f7f7f7").style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","middle"))})),x.value.selectAll(".first-group-element").transition().duration(J).ease(Q).attr("transform",(p,d)=>`translate(0, ${d*k})`),e(),r()}function m(t){return t==="mouseover"?At:b}function X(t){return t==="mouseover"?At:nt}function Z(t){return t==="mouseover"?"2.5px":st}function at(t){return t==="mouseover"?"bold":"regular"}function Vt(){x.value.selectAll(".group-element").on("mouseover mouseout",function(t){const e=s.select(this).attr("data-index");a.detailsMapGraph.children[e].data.children.length&&s.selectAll(`line.element-${e}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),s.selectAll(`.connection-line-${e}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),e===C.value&&s.selectAll(".shown-work-rect").attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(`.element-${e} circle`).attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(`.element-${e} .sdg-group-id`).attr("fill",m(t.type)).attr("font-weight",at(t.type)),s.selectAll(`.element-${e} .field-group-name`).attr("fill",m(t.type)).attr("font-weight",at(t.type))})}const C=W(null),U=W([]),R=W([]);$t(()=>C.value,()=>{a.detailsMapGraph.type==="works"?ht(mt,xt):vt(kt,yt)});function qt(){x.value.selectAll(".group-element").on("click",function(){const t=s.select(this).attr("data-index");if(a.detailsMapGraph.children[t].data.children.length?C.value=t:C.value=null,a.detailsMapGraph.children[t].data.children.length){const e=a.detailsMapGraph.children[t].data.children;U.value=e}else U.value=[]})}function Kt(){x.value.selectAll(".group-element").on("click",function(){const t=s.select(this).attr("data-index");if(a.detailsMapGraph.children[t].children.length?C.value=t:C.value=null,a.detailsMapGraph.children[t].children.length){const e=a.detailsMapGraph.children[t].children;R.value=e}else R.value=[]})}function ht(t,e){const r=v.value.selectAll(".shown-work").data(U.value,function(f){return f}),p=r.enter().append("g").attr("class","shown-work").attr("transform",`translate(0, -${G*2})`);p.append("rect").attr("class","shown-work-rect").attr("data-id",(f,u)=>u),p.append("text").attr("class","shown-work-title").text(f=>f.title),p.append("rect").attr("class","shown-work-overlay").data(U.value,function(f,u){return u});const d=p.merge(r);d.select(".shown-work-title").text(f=>f.title),d.select(".shown-work-overlay title").text(f=>f.title),r.exit().remove(),v.value.selectAll(".shown-work-rect,.shown-work-overlay").attr("width",()=>n.isMobile?o.value*.9:o.value*.5).attr("height",l.sizes.worksBandwidth),v.value.selectAll(".shown-work-rect").attr("stroke",b).attr("fill",b),v.value.selectAll(".shown-work-overlay").attr("class","shown-work-overlay").attr("data-id",(f,u)=>u).attr("fill-opacity",0).attr("cursor","pointer"),v.value.selectAll(".shown-work-title").attr("x",5).attr("y",l.sizes.worksBandwidth*.85).style("font-size",l.sizes.workTitle).attr("fill","#f7f7f7"),v.value.selectAll(".shown-work").transition().duration(J).ease(Q).attr("transform",(f,u)=>`translate(0, ${G*u})`),t(),e(Xt)}function Qt(t){const e=n.isMobile?o.value*.9+y*1.5:o.value*.4+y*1.5,r=t*k,p=n.isMobile?o.value*.96:o.value*.4+y*4,d=n.isMobile?o.value*.96:o.value*.4+y*8,i=n.isMobile?a.detailsMapGraph.children.length*k+(U.value.length-1)*.5*G+l.sizes.worksBandwidth*.5:l.sizes.worksBandwidth*.5,f=n.isMobile?o.value*.92:o.value*.495,u=n.isMobile?a.detailsMapGraph.children.length*k+(U.value.length-1)*.5*G+l.sizes.worksBandwidth*.5:(U.value.length-1)*.5*G+l.sizes.worksBandwidth*.5;return[[{x:e,y:r},{x:p,y:r},{x:d,y:i},{x:f,y:u}]]}function ft(t){return s.line().x(r=>r.x).y(r=>r.y).curve(s.curveCatmullRom.alpha(.5))(t)}function mt(){const t=C.value?Qt(C.value):[];s.selectAll(".connection-line").remove(),x.value.selectAll(".connection-line").data(t).join(e=>e.append("path").attr("class",["connection-line",`connection-line-${C.value}`].join(" ")).attr("d",r=>ft(r)).attr("stroke","white").attr("fill","none").attr("stroke-width",st),e=>e,e=>e),x.value.selectAll(".connection-line").transition().duration(J*.3).attr("stroke",nt)}const et=W(null);function wt(t){et.value.select(".tooltip-title").text(t.title),et.value.select(".tooltip-citation").text(`${t.year}${t.source.name?`: ${t.source.name}`:""}`)}function gt(t){t==="mouseover"?et.value.classed("visible",!0):et.value.classed("visible",!1),et.value.style("width",`${o.value}px`).style("left",`${(n.width-n.modalWidth)/2}px`).style("top",0)}function xt(t){v.value.selectAll(".shown-work-overlay").on("mouseover mouseout",function(e,r){const p=C.value,d=s.select(this).attr("data-id");s.select(`.shown-work-rect[data-id='${d}']`).attr("stroke",m(e.type)).attr("fill",m(e.type)),s.selectAll(`line.element-${p}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.connection-line-${p}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.element-${p} circle`).attr("stroke",m(e.type)).attr("fill",m(e.type)),s.selectAll(`.element-${p} .sdg-group-id`).attr("fill",m(e.type)).attr("font-weight",at(e.type)),s.selectAll(`.element-${p} .field-group-name`).attr("fill",m(e.type)).attr("font-weight",at(e.type)),wt(r),gt(e.type,this.getBoundingClientRect())}),t()}function Xt(){v.value.selectAll(".shown-work-overlay").on("click",async function(){et.value.style("visibility","hidden");const t=s.select(this).attr("data-id"),e={type:"works",root:U.value[t],sizes:l.sizes},r=await Ct(e);a.setDetailsMapGraph(r),U.value=[],C.value=null,B(),h()})}function Zt(t,e,r){e(t,Jt,Kt),x.value.selectAll(".first-group-line").data(t).join(p=>p.append("line").attr("class",(d,i)=>["first-group-line",`element-${i}`].join(" ")).attr("stroke",d=>d.children.length?nt:null).attr("stroke-width",st).attr("x1",n.isMobile?o.value*.75:o.value*.45).attr("y1",(d,i)=>i*G+l.sizes.worksBandwidth*.5).attr("x2",n.isMobile?o.value*.9-y*1.5*2:o.value*.5-y*1.5).attr("y2",(d,i)=>i*G+l.sizes.worksBandwidth*.5)),r(kt,yt)}function Yt(t,e,r){x.value.selectAll(".first-group-element").data(t).join(p=>p.append("g").attr("class",(d,i)=>["first-group-element",`element-${i}`].join(" ")).attr("transform",`translate(0, -${G*2})`).each(function(d,i){const f=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i);f.append("rect").attr("class","first-group-work-rect").attr("data-id",i),f.append("text").attr("class","first-group-work-title").attr("data-id",w=>w.id).text(w=>w.title),f.append("rect").attr("class","first-group-work-overlay");const u=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("transform",`translate(${n.isMobile?o.value*.9-y*1.5:o.value*.5},${l.sizes.worksBandwidth*.5})`).attr("cursor","pointer");d.children.length&&(u.append("circle").attr("class","first-group-work-circle").attr("r",y*1.4).attr("stroke",b).attr("fill",b),u.append("text").text(w=>w.children.length).attr("fill","#f7f7f7").style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor","middle"))})),x.value.selectAll(".first-group-work-rect,.first-group-work-overlay").attr("width",()=>n.isMobile?o.value*.75:o.value*.45).attr("height",l.sizes.worksBandwidth),x.value.selectAll(".first-group-work-rect").attr("stroke",b).attr("fill",b),x.value.selectAll(".first-group-work-overlay").attr("fill-opacity",0).attr("cursor","pointer"),x.value.selectAll(".first-group-work-title").attr("x",5).attr("y",l.sizes.worksBandwidth*.85).style("font-size",l.sizes.workTitle).attr("fill","white"),x.value.selectAll(".first-group-element").transition().duration(J).ease(Q).attr("transform",(p,d)=>`translate(0, ${G*d})`),e(),r()}function Jt(){x.value.selectAll(".group-element").on("mouseover mouseout",function(t,e){const r=s.select(this).attr("data-index");a.detailsMapGraph.children[r].children.length&&s.selectAll(`line.element-${r}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),s.selectAll(`.connection-line-${r}`).attr("stroke",X(t.type)).attr("stroke-width",Z(t.type)),r===C.value&&(s.selectAll(".shown-element-circle").attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(".shown-sdg-group-id, .shown-field-group-name").attr("fill",m(t.type)).attr("font-weight",at(t.type))),s.selectAll(`.element-${r} .first-group-work-circle`).attr("stroke",m(t.type)).attr("fill",m(t.type)),s.selectAll(`.element-${r} .first-group-work-rect`).attr("stroke",m(t.type)).attr("fill",m(t.type)),wt(e),gt(t.type,this.getBoundingClientRect())})}function vt(t,e){s.selectAll(".shown-element").remove(),v.value.selectAll(".shown-element").data(R.value,function(d){return d}).enter().append("g").attr("class","shown-element").attr("data-id",(d,i)=>i).attr("transform",`translate(${n.isMobile?o.value*.85:o.value*.15}, -${k*2})`).each(function(d,i){if(d.type==="sdg"){const f=a.homeMapGraph.sdgs.find(w=>w.id===d.data.id),u=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");u.append("circle").attr("class","shown-element-circle").attr("data-id",w=>w.id).attr("r",y).attr("stroke",b).attr("fill",b),u.append("text").attr("class","shown-sdg-group-id").text(w=>`SDG ${w.data.id}`).attr("x",()=>n.isMobile?-$:$).attr("y",0).style("font-size",`${l.sizes.sdgId}px`).attr("dominant-baseline","text-after-edge").attr("text-anchor",()=>n.isMobile?"end":"start"),u.append("rect").attr("x",n.isMobile?-(f.labelBbox.width+$):$).attr("y",0).attr("fill",w=>w.data.color).attr("opacity",.4).attr("width",f.labelBbox.width).attr("height",f.labelBbox.height),u.append("text").text(w=>w.data.name).attr("x",()=>n.isMobile?-$:$).attr("y",0).attr("dominant-baseline","text-before-edge").style("font-size",l.sizes.sdgLabel).attr("text-anchor",()=>n.isMobile?"end":"start")}else{const f=s.select(this).append("g").attr("class",["group-element",`element-${i}`].join(" ")).attr("data-index",i).attr("cursor","pointer");f.append("circle").attr("class","shown-element-circle").attr("data-id",u=>u.id).attr("r",y).attr("stroke",b).attr("fill",b),f.append("text").attr("class","shown-field-group-name").text(u=>u.data.name).attr("x",()=>n.isMobile?-$:$).attr("y",0).style("font-size",`${l.sizes.field}px`).attr("dominant-baseline","middle").attr("text-anchor",()=>n.isMobile?"end":"start")}}),v.value.selectAll(".shown-element").transition().duration(J).ease(Q).attr("transform",(d,i)=>`translate(${n.isMobile?o.value*.9-y*1.5:o.value*.15}, ${k*i})`),t(),e(ee)}function te(t){const e=n.isMobile?o.value*.9:y*1.5,r=t*G+l.sizes.worksBandwidth*.5,p=n.isMobile?o.value*.95:o.value*.1,d=n.isMobile?o.value*.95:o.value*.1,i=n.isMobile?a.detailsMapGraph.children.length*G+R.value.length*.5*k+k*.25:(R.value.length-1)*.5*k,f=n.isMobile?o.value*.9:o.value*.14,u=n.isMobile?a.detailsMapGraph.children.length*G+R.value.length*.5*k+k*.25:(R.value.length-1)*.5*k;return[[{x:e,y:r},{x:p,y:r},{x:d,y:i},{x:f,y:u}]]}function kt(){const t=C.value?te(C.value):[],e=n.isMobile?x.value:v.value;s.selectAll(".connection-line").remove(),e.selectAll(".connection-line").data(t).join(r=>r.append("path").attr("class",["connection-line",`connection-line-${C.value}`].join(" ")).attr("d",p=>ft(p)).attr("stroke","white").attr("fill","none").attr("stroke-width",st),r=>r,r=>r),e.selectAll(".connection-line").transition().duration(J*.3).attr("stroke",nt)}function yt(t){v.value.selectAll(".shown-element").on("mouseover mouseout",function(e){const r=C.value;s.select(this).select(".shown-element-circle").attr("stroke",m(e.type)).attr("fill",m(e.type)),s.select(this).select(".shown-sdg-group-id, .shown-field-group-name").attr("fill",m(e.type)).attr("font-weight",at(e.type)),s.selectAll(`line.element-${r}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.connection-line-${r}`).attr("stroke",X(e.type)).attr("stroke-width",Z(e.type)),s.selectAll(`.element-${r} .first-group-work-circle`).attr("stroke",m(e.type)).attr("fill",m(e.type)),s.selectAll(`.element-${r} .first-group-work-rect`).attr("stroke",m(e.type)).attr("fill",m(e.type))}),t()}function ee(){v.value.selectAll(".shown-element").on("click",async function(){const t=s.select(this).attr("data-id");let e=R.value[t].data;if(R.value[t].type==="sdg"){const d=a.homeMapGraph.sdgs.find(i=>i.id===e.id);e.labelBbox=d.labelBbox}const r={type:`${R.value[t].type}s`,root:e,sizes:l.sizes},p=await Ct(r);a.setDetailsMapGraph(p),R.value=[],C.value=null,B(),h()})}const ae=q(()=>n.isMobile?22:25),ot=q(()=>_.papersInSpace.includes(a.detailsMapGraph.data.openAlexId)),re=q(()=>ot.value?"in Paper Space":"add to Paper Space");function le(){ot.value?_.removeFromPaperSpace(a.detailsMapGraph.data.openAlexId):_.addToPaperSpace(E,{query:g.searchQuery,...a.detailsMapGraph.data})}return(t,e)=>(tt(),rt(Ee,null,[ra,j(a).detailsMapGraph.type==="works"?(tt(),rt("div",{key:0,style:ze({"font-size":l.sizes.workTitle})},[A("div",la,[A("a",{href:j(a).detailsMapGraph.data.openAlexId,target:"_blank"},[A("div",null,dt(j(a).detailsMapGraph.data.title),1)],8,na)]),A("div",sa,[A("a",{href:j(a).detailsMapGraph.data.doi,target:"_blank"},dt(j(a).detailsMapGraph.data.citation),9,oa)]),j(a).detailsMapGraph.data.abstract?(tt(),rt("div",ia,[ct(j(Oe),null,{default:pt(()=>[ct(j(Ve),{title:"Abstract",name:"abstract"},{default:pt(()=>[A("div",null,dt(j(a).detailsMapGraph.data.abstract),1)]),_:1})]),_:1})])):Gt("",!0),A("div",{class:"paper-space-controls",onClick:le},[ct(Se,{name:"fade",mode:"out-in"},{default:pt(()=>[(tt(),rt("div",{key:ot.value?"in-space":"not-in-space",class:"icon-text-wrapper"},[ct(j(Ae),{size:ae.value},{default:pt(()=>[ot.value?(tt(),_t(j(aa),{key:0})):(tt(),_t(j(Ye),{key:1}))]),_:1},8,["size"]),A("span",null,dt(re.value),1)]))]),_:1})])],4)):Gt("",!0),da],64))}},ma=be(ca,[["__scopeId","data-v-9e94458a"]]);export{ma as default};
